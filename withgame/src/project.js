window.__require=function e(t,r,n){function a(i,s){if(!r[i]){if(!t[i]){var c=i.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+i+"'")}}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){return a(t[i][1][e]||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof __require&&__require,i=0;i<n.length;i++)a(n[i]);return a}({AIManager:[function(e,t,r){"use strict";cc._RF.push(t,"43853D1mZJB1Jr+MqO0VQ8t","AIManager");var n=i(e("AI/RoleData")),a=i(e("AI/ActionData")),o=e("./Tools");function i(e){return e&&e.__esModule?e:{default:e}}var s=cc.Class({extends:cc.Component,properties:{_roleList:null},addRoleObj:function(t,r){null!=this._roleList&&void 0!=this._roleList||(this._roleList=new Object);var a=n.default[t],o=new Object;o.role=r,o.behaviorData=e(a.Behavior),o.isOverGroupAttack=!0,o.duration=0,o.currentTimer=Date.now(),o.behaviorList=new Array,this._roleList[t]=o,console.log("\u5f53\u524d\u89d2\u8272\u6570\u636e:",this._roleList)},updateNewBehavior:function(e){var t=void 0;if(e.isOverGroupAttack){var r=this.getBehavior(e.behaviorData);if(console.log(r),r.subset=JSON.parse('{"0":{"type":"singleAttack","id":"1000"},"1":{"type":"groupAttack","id":"1000|1000|1001"}}'),t=r.name,cc.log(t),"attack"===t){var n=(0,o.getRandomArray)(r.subset)[0];e.attackList=n.id.split("|"),this.updateAttack(e)}else e.duration=parseInt(r.Duration)}else this.updateAttack(e);e.currentTimer=Date.now(),e.role[t]()},updateAttack:function(e){var t=e.attackList.shift();e.isOverGroupAttack=e.attackList.length<=0,e.duration=parseInt(a.default[t].BeforeAttack)+parseInt(a.default[t].AfterAttack)},getBehavior:function(e){for(var t=(0,o.getRandomNum)(0,99),r=0;r<e.length;r++){var n=e[r],a=e[r-1];if(t>=(a?parseInt(a.Percent):0)&&t<parseInt(n.Percent))return e[r]}return e[0]},update:function(e){for(var t in this._roleList){var r=this._roleList[t];Date.now()-r.currentTimer>=r.duration&&this.updateNewBehavior(r)}}});t.exports=s,cc._RF.pop()},{"./Tools":"Tools","AI/ActionData":void 0,"AI/RoleData":void 0}],ActionData:[function(e,t,r){"use strict";cc._RF.push(t,"adb57/XDvpH54aUCjGDG5nR","ActionData");var n=[];n[1e3]={PID:"1000",Name:"\u51fa\u62f3",BeforeAttack:"1000",AfterAttack:"1000",BaseDamage:"2"},n[1001]={PID:"1001",Name:"\u51fa\u638c",BeforeAttack:"1000",AfterAttack:"1000",BaseDamage:"2"},n[1002]={PID:"1002",Name:"\u8e22\u817f",BeforeAttack:"1500",AfterAttack:"1500",BaseDamage:"4"},t.exports=n,cc._RF.pop()},{}],Behavior_0:[function(e,t,r){"use strict";cc._RF.push(t,"5ee59DvdtNLqpJkVUPacl4i","Behavior_0");var n=[];n[0]={PID:"0",name:"idle",BehaviorType:"0",Duration:"3000",Percent:"10",subset:""},n[1]={PID:"1",name:"attack",BehaviorType:"1",Duration:"",Percent:"40",subset:""},n[2]={PID:"2",name:"defend",BehaviorType:"3",Duration:"1000",Percent:"50",subset:""},n[3]={PID:"3",name:"dodge",BehaviorType:"4",Duration:"1000",Percent:"60",subset:""},n[4]={PID:"4",name:"rebound",BehaviorType:"5",Duration:"1000",Percent:"70",subset:""},t.exports=n,cc._RF.pop()},{}],Game:[function(e,t,r){"use strict";cc._RF.push(t,"81914mclsxHSqBfxLm6hZSW","Game"),cc.Class({extends:cc.Component,properties:{aiNode:cc.Node,player:cc.Node,monster:cc.Node,defendButton:cc.Node},start:function(){this.playerComponent=this.player.getComponent("Unit"),this.monsterComponent=this.monster.getComponent("Unit"),this.playerComponent.setTarget(this.monsterComponent),this.monsterComponent.setTarget(this.playerComponent),this.aiNode.getComponent("AIManager").addRoleObj("2000",this.monsterComponent),this.timerAI=Date.now(),this.defendButton.on(cc.Node.EventType.TOUCH_START,this.defend.bind(this))},attack:function(){this.playerComponent.attack()},rebound:function(){this.playerComponent.rebound()},dodge:function(){this.playerComponent.dodge()},stopDefend:function(){this.playerComponent.stopDefend()},defend:function(){this.playerComponent.defend()}}),cc._RF.pop()},{}],PlayerModel:[function(e,t,r){"use strict";cc._RF.push(t,"dbaeaCOz85Kjqx/HUbiQRPH","PlayerModel"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("./UnitModel"));function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,n.default),t}();r.default=s,t.exports=r.default,cc._RF.pop()},{"./UnitModel":"UnitModel"}],RoleData:[function(e,t,r){"use strict";cc._RF.push(t,"e2eect3UQRMrJTRL3CLUFuG","RoleData");var n=[];n[2e3]={PID:"2000",Name:"Boss1",RoleType:"0",BaseHP:"150",Behavior:"Behavior_0",Action:"1000|1001|1002"},n[2001]={PID:"2001",Name:"Boss2",RoleType:"0",BaseHP:"150",Behavior:"Behavior_0",Action:"1000|1001|1002"},t.exports=n,cc._RF.pop()},{}],Tools:[function(e,t,r){"use strict";cc._RF.push(t,"23053IB2VlIUojJE1GiLJAM","Tools"),Object.defineProperty(r,"__esModule",{value:!0}),r.getRandomNum=function(e,t){return parseInt(Math.random()*(t-e+1)+e)},r.getRandomArray=function(e){for(var t=e.length,r=0;r<t;r++){var n=parseInt(t*Math.random()),a=e[r];e[r]=e[n],e[n]=a}return e},cc._RF.pop()},{}],UnitCommand:[function(e,t,r){"use strict";cc._RF.push(t,"cada87tMrdHN7dfLRsWXj/m","UnitCommand"),Object.defineProperty(r,"__esModule",{value:!0}),r.setTarget=function(e,t){e.currentTarget=t},r.idle=a,r.attack=function(e){if(e.currentState!==n.default.IDLE||e.sp<=0)return;o(e),e.sp-=p},r.rebound=function(e){if(e.currentState!==n.default.IDLE||e.sp<=0)return;e.currentState=n.default.REBOUND,e.currentTimer=Date.now(),e.sp-=p},r.defend=function(e){if(e.currentState!==n.default.IDLE||e.sp<=0)return;e.currentState=n.default.DEFENSE,e.currentTimer=Date.now()},r.stopDefend=function(e){if(e.currentState!==n.default.DEFENSE)return;a(e)},r.dodge=function(e){if(e.currentState!==n.default.IDLE||e.sp<=0)return;e.currentState=n.default.DODGE,e.currentTimer=Date.now(),e.sp-=p},r.reset=function(e){e.hp=100,e.sp=100,e.mp=0,e.currentState=n.default.IDLE,e.currentTarget=null},r.tick=function(e){switch(e.currentState){case n.default.IDLE:Date.now()-e.currentTimer>=h&&(e.sp+=1,e.sp>100&&(e.sp=100));break;case n.default.ATTACK:s(e),i(e);break;case n.default.CHARGE_ATTACK:break;case n.default.REBOUND:Date.now()-e.currentTimer>=m?a(e):e.rebounding=1-(Date.now()-e.currentTimer)/m;break;case n.default.DEFENSE:e.sp<=0&&a(e);break;case n.default.DODGE:Date.now()-e.currentTimer>=f?a(e):e.dodging=1-(Date.now()-e.currentTimer)/f;break;case n.default.BEFORE_ATTACK:Date.now()-e.currentTimer>=u?e.currentState=n.default.ATTACK:e.attacking=(Date.now()-e.currentTimer)/u;break;case n.default.AFTER_ATTACK:Date.now()-e.currentTimer>=d?a(e):e.attacking=1-(Date.now()-e.currentTimer)/d;break;case n.default.GET_HURT:e.hp-=l,cc.log(e.hp),e.hp>0?a(e):c(e);break;case n.default.STIFFNESS:Date.now()-e.currentTimer>=D?a(e):(e.sitffness=1-(Date.now()-e.currentTimer)/D,e.isRestoreSitffness&&Date.now()-e.currentTimer>=g&&(e.sp+=1,e.sp>100&&(e.sp=100)));break;case n.default.DEAD:e.isDead=!0;break;case n.default.RESURGENCE:}};var n=function(e){return e&&e.__esModule?e:{default:e}}(e("config/UnitState"));function a(e){e.currentState!==n.default.IDLE&&(e.sp<=0?(e.currentState=n.default.STIFFNESS,e.isRestoreSitffness=!0,e.currentTimer=Date.now()):(e.isRestoreSitffness||(e.currentTimer=Date.now()),e.currentState=n.default.IDLE,e.isRestoreSitffness=!1),e.attacking=0,e.dodging=0,e.rebounding=0,e.sitffness=0)}function o(e){e.currentState=n.default.BEFORE_ATTACK,e.currentTimer=Date.now()}function i(e){e.currentState!==n.default.STIFFNESS?(e.currentState=n.default.AFTER_ATTACK,e.currentTimer=Date.now()):e.attacking=0}function s(e){e.currentTarget.currentState===n.default.DODGE||(e.currentTarget.currentState===n.default.DEFENSE?(e.currentTarget.sp-=p,e.currentTarget.sp<=0&&a(e)):e.currentTarget.currentState===n.default.REBOUND?(e.currentState=n.default.STIFFNESS,e.currentTimer=Date.now()):(e.currentTarget.currentState=n.default.GET_HURT,e.mp+=l))}function c(e){e.currentState=n.default.DEAD,e.attacking=0,e.dodging=0,e.rebounding=0,e.sitffness=0}var u=500,d=500,f=500,l=5,p=30,h=500,m=500,D=2e3,g=500;cc._RF.pop()},{"config/UnitState":void 0}],UnitModel:[function(e,t,r){"use strict";cc._RF.push(t,"60799phGbZPk51Db8qGHiz4","UnitModel"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("config/UnitState"));function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.default=function e(){a(this,e),this.hp=100,this.sp=100,this.mp=0,this.attacking=0,this.dodging=0,this.rebounding=0,this.sitffness=0,this.isDead=!1,this.currentState=n.default.IDLE,this.currentTarget=null,this.isRestoreSitffness=!1},t.exports=r.default,cc._RF.pop()},{"config/UnitState":void 0}],UnitState:[function(e,t,r){"use strict";cc._RF.push(t,"e4405IVm5RJVYGrDy7nAxOJ","UnitState"),Object.defineProperty(r,"__esModule",{value:!0}),r.default={IDLE:0,ATTACK:1,CHARGE_ATTACK:2,DEFENSE:3,DODGE:4,REBOUND:5,BEFORE_ATTACK:6,AFTER_ATTACK:7,GET_HURT:8,STIFFNESS:9,DEAD:10,RESURGENCE:11,GROUP_ATTACK:20},t.exports=r.default,cc._RF.pop()},{}],Unit:[function(e,t,r){"use strict";cc._RF.push(t,"08c02StuDpMTqaCh4eg/laM","Unit");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("./Models/UnitModel")),a=e("./Commands/UnitCommand");cc.Class({extends:cc.Component,properties:{hpBar:cc.ProgressBar,spBar:cc.ProgressBar,mpBar:cc.ProgressBar,attackingBar:cc.ProgressBar,dodgingBar:cc.ProgressBar,reboundingBar:cc.ProgressBar,sitffnessBar:cc.ProgressBar,gameOverLabel:cc.Node},onLoad:function(){this.model=new n.default},start:function(){this.updateState(),this.currentTimer=Date.now(),this.gameOverLabel.active=!1},updateState:function(){this.hpBar.progress=this.model.hp/100,this.spBar.progress=this.model.sp/100,this.mpBar.progress=this.model.mp/100,this.attackingBar.progress=this.model.attacking,this.dodgingBar.progress=this.model.dodging,this.reboundingBar.progress=this.model.rebounding,this.sitffnessBar.progress=this.model.sitffness,this.gameOverLabel.active=this.model.isDead},setTarget:function(e){(0,a.setTarget)(this.model,e.model)},idle:function(){(0,a.idle)(this.model)},attack:function(){(0,a.attack)(this.model)},rebound:function(){(0,a.rebound)(this.model)},dodge:function(){(0,a.dodge)(this.model)},defend:function(){(0,a.defend)(this.model)},stopDefend:function(){(0,a.stopDefend)(this.model)},update:function(e){this.model.isDead||((0,a.tick)(this.model),this.updateState())}}),cc._RF.pop()},{"./Commands/UnitCommand":"UnitCommand","./Models/UnitModel":"UnitModel"}],"use_v2.1.x_cc.Action":[function(e,t,r){"use strict";cc._RF.push(t,"e8e2aEYDQBBeYyVoGFCDaHl","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}]},{},["AIManager","ActionData","Behavior_0","RoleData","Tools","UnitCommand","UnitState","Game","PlayerModel","UnitModel","Unit","use_v2.1.x_cc.Action"]);